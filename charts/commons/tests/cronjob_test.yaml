suite: Test CronJob template
values:
  - ./values/values.yaml
templates:
  - templates/cronjob.yaml
release:
  name: test
tests:
  - it: Vérifie le cronjob
    documentSelector:
      path: metadata.name
      value: test-nginx
    asserts:
      - equal:
          path: kind
          value: CronJob
      - equal:
          path: spec.schedule
          value: "0 3 * * *"
      - equal:
          path: spec.successfulJobsHistoryLimit
          value: 3
      - equal:
          path: spec.jobTemplate.spec.template.spec.containers[0].image
          value: "nginx:latest"

  - it: Vérifie le cron
    documentSelector:
      path: metadata.name
      value: test-nginx
    asserts:
      - equal:
          path: kind
          value: Job
      - equal:
          path: spec.jobTemplate.spec.containers[0].image
          value: "nginx:latest"