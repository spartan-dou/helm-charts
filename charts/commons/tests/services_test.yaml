suite: Tests complets du chart commons
templates:
  - templates/services.yaml

tests:
  # --- Services ---
  - it: Vérifie le Service web
    documentSelector:
      kind: Service
      metadata:
        name: test-commons
    asserts:
      - equal:
          path: spec.ports[0].port
          value: 80
      - equal:
          path: spec.ports[0].targetPort
          value: 8080
      - equal:
          path: spec.selector.app
          value: web

  - it: Vérifie le Service vscode
    documentSelector:
      kind: Service
      metadata:
        name: test-commons-vscode
    asserts:
      - equal:
          path: spec.ports[0].port
          value: 8080
      - equal:
          path: spec.selector.app
          value: vscode

  - it: Vérifie le Service redis
    documentSelector:
      kind: Service
      metadata:
        name: test-commons-redis
    asserts:
      - equal:
          path: spec.ports[0].port
          value: 6379
      - equal:
          path: spec.selector.app
          value: redis