# yaml-language-server: $schema=https://raw.githubusercontent.com/helm-unittest/helm-unittest/main/schema/helm-testsuite.json
suite: Tests complets du chart commons
values:
  - ./values/values.yaml
release:
  name: test
tests:
  # --- Secret ---
  - it: Vérifie le Secret Postgres
    templates:
      - templates/cnpg/secret.yaml
    documentSelector:
      path: metadata.name
      value: test-nginx-postgres-secret
    asserts:
      - equal:
          path: type
          value: kubernetes.io/basic-auth
      - equal:
          path: data.username
          value: Y2hhbmdlbWU=
      - equal:
          path: data.password
          value: Y2hhbmdlbWU=

  # --- Secret ---
  - it: Vérifie le Secret Postgres
    templates:
      - templates/cnpg/secret.yaml
    documentSelector:
      path: metadata.name
      value: test-postgres-secret
    asserts:
      - equal:
          path: type
          value: kubernetes.io/basic-auth
      - equal:
          path: data.username
          value: Y2hhbmdlbWU=
      - equal:
          path: data.password
          value: Y2hhbmdlbWU=